<div class="container">
    <!-- Header Spanning Full Width -->
    <div class="game-header">
        <h1>ğŸ® Bingo Game</h1>
        <div class="header-info">
            <span class="player-badge">ğŸ‘¤ {{ userName }}</span>
            <button class="btn-secondary btn-sm" (click)="backToLobby()">
                ğŸšª Leave
            </button>
        </div>
    </div>

    <!-- STATUS BANNER (MOVED HERE FOR RESPONSIVENESS) -->
    <div class="status-banner-container">
        <div class="status-card" [class.my-turn]="isMyTurn">
            <h2>
                {{ isMyTurn ? 'ğŸ¯ YOUR TURN' : 'â³ OPPONENT\'S TURN' }}
            </h2>
            <p class="status-sub">
                {{ isMyTurn ? 'Click a number on your ticket to call it!' : 'Waiting for opponent...' }}
            </p>

            <div class="turn-timer" *ngIf="isMyTurn && timeLeft > 0">
                <span [class.urgent]="timeLeft <= 5">â³ {{ timeLeft }}s</span>
            </div>

            <!-- BINGO Letters moved here -->
            <div class="bingo-status-letters">
                <div *ngFor="let letter of bingoLetters; let i = index" class="status-letter"
                    [class.marked]="markedBingoLetters[i]">
                    {{ letter }}
                </div>
            </div>
        </div>
    </div>

    <div class="split-layout">
        <!-- LEFT PANEL: TICKET -->
        <div class="left-panel">
            <div class="ticket-card">
                <div class="ticket-header">
                    <h3>ğŸ« Your Ticket</h3>
                    <div class="lines-tracker">
                        <span>Lines: </span>
                        <span class="count">{{ getCompletedLinesCount() }}/5</span>
                    </div>
                </div>

                <div class="ticket-wrapper">
                    <table class="bingo-grid">
                        <thead>
                            <tr>
                                <th *ngFor="let l of bingoLetters">{{ l }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let row of myTicket.numbers; let i = index">
                                <td *ngFor="let num of row; let j = index" (click)="onTicketCellClick(num)"
                                    [class.called]="isNumberCalled(num)" [class.marked]="isMarked(i, j)"
                                    [class.my-pick]="isMyPick(num)" [class.opp-pick]="isOppPick(num)"
                                    [class.clickable-turn]="isMyTurn && !isNumberCalled(num)"
                                    [class.strike-row]="completedRows.has(i)" [class.strike-col]="completedCols.has(j)">
                                    {{ num }}
                                    <div class="mark-indicator" *ngIf="isMarked(i, j)">âœ“</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="ticket-legend">
                    <div class="legend-item"><span class="legend-box my-pick-legend"></span> You (Green)</div>
                    <div class="legend-item"><span class="legend-box opp-pick-legend"></span> Opponent (Blue)</div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL: GAME CONTROLS -->
        <div class="right-panel">
            <!-- Status Card Removed -->

            <!-- Panel removed as requested -->

            <!-- 3. Called Numbers History -->
            <div class="history-card">
                <h3>ğŸ“‹ History ({{ calledNumbers.length }})</h3>
                <div class="history-grid">
                    <span *ngFor="let item of drawnHistory.slice().reverse()" class="history-chip"
                        [class.my-pick]="item.playerId === playerId"
                        [class.opp-pick]="item.playerId !== null && item.playerId !== playerId">
                        {{ item.number }}
                    </span>
                    <span *ngIf="drawnHistory.length === 0" class="empty-text">No numbers called</span>
                </div>
            </div>
        </div>
    </div>
</div>